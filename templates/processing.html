<!DOCTYPE html>
<html lang="en">

<head>
    <title>Traitez votre image</title>

    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">

    <link href="../static/jumbotron-narrow.css" rel="stylesheet">

    <link href="../static/style.css" rel="stylesheet">

    <!-- Font Awesome for icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

</head>

<body>

    <div class="container">
        <div class="header">
            <nav>
                <ul class="nav nav-pills pull-right">
                    <li role="presentation" class="active"><a href="/">Accueil</a>
                    </li>
                    <li role="presentation"><a href="https://github.com/Melissa-Amrouche/TransformationImages">Dépôt Git</a>
                    </li>
                </ul>
            </nav>
            <h3 class="text-muted">Traitez votre image</h3>
        </div>

        <div class="jumbotron">
            <div class="image-preview-container">
                <div class="original-image-box">
                    <h4>Image Originale</h4>
                    <img id="original-image" src=" {{url_for('send_image', filename=image_name)}} " style="max-width: 100%;">
                </div>
                <div class="preview-image-box">
                    <h4>Aperçu en temps réel</h4>
                    <img id="preview-image" src=" {{url_for('send_image', filename=image_name)}} " style="max-width: 100%;">
                    <div id="loading-spinner" class="hidden">
                        <i class="fa fa-spinner fa-spin"></i> Traitement en cours...
                    </div>
                </div>
            </div>
        </div>

        <div class="row marketing">
            <div class="col-lg-6">
                <h4>Retourner</h4>
                <form id="form-flip" action="{{ url_for('flip') }}" method="POST" enctype="multipart/form-data">
                    <button id="btnFlipV" class="btn btn-lg btn-success" type="submit" name="mode" value="vertical">Vertical</button>
                    <button id="btnFlipH" class="btn btn-lg btn-success" type="submit" name="mode" value="horizontal">Horizontal</button>
                    <input type="text" class="hidden" name="image" value="{{ image_name }}">
                </form>


                <h4>Rogner</h4>
                <form id="form-crop" action="{{ url_for('crop') }}" method="POST" enctype="multipart/form-data">
                    <input type="number" placeholder="x1" min="0" name="x1" required>
                    <input type="number" placeholder="y1" min="0" name="y1" required>
                    <input type="number" placeholder="x2" min="0" name="x2" required>
                    <input type="number" placeholder="y2" min="0" name="y2" required>
                    <button id="btnCrop" class="btn btn-lg btn-success" type="submit">Valider</button>
                    <input type="text" class="hidden" name="image" value="{{ image_name }}">
                </form>

                <h4>Convertir</h4>
                <form id="form-convert" action="{{ url_for('grayscale') }}" method="POST" enctype="multipart/form-data">
                    <button id="btnGrayscale" class="btn btn-lg btn-info" type="submit" name="mode" value="grayscale">
                        <i class="fa fa-adjust"></i> Niveaux de Gris
                    </button>
                    <button id="btnBlackWhite" class="btn btn-lg btn-info" type="submit" name="mode" value="blackwhite">
                        <i class="fa fa-circle-half-stroke"></i> Noir & Blanc
                    </button>
                    <button id="btnRestoreColor" class="btn btn-lg btn-warning" type="submit" name="mode" value="color">
                        <i class="fa fa-palette"></i> Couleur Originale
                    </button>
                    <input type="text" class="hidden" name="image" value="{{ image_name }}">
                </form>

            </div>

            <div class="col-lg-6">
                <h4>Fusionner avec une 2e image</h4>
                <div id="overlay-section">
                    <input type="file" id="overlay-file-picker" accept="image/*" class="hidden">
                    <label for="overlay-file-picker" class="btn btn-lg btn-primary">
                        <i class="fa fa-plus"></i> Importer 2e image
                    </label>

                    <div id="overlay-controls" class="hidden" style="margin-top: 15px; padding: 15px; background: #f5f5f5; border-radius: 5px;">
                        <h5>Contrôles de superposition</h5>

                        <div class="form-group">
                            <label>Position X : <span id="overlay-x-value">50</span>%</label>
                            <input type="range" id="overlay-x-slider" class="form-control" min="0" max="100" value="50" step="1">
                        </div>

                        <div class="form-group">
                            <label>Position Y : <span id="overlay-y-value">50</span>%</label>
                            <input type="range" id="overlay-y-slider" class="form-control" min="0" max="100" value="50" step="1">
                        </div>

                        <div class="form-group">
                            <label>Échelle : <span id="overlay-scale-value">50</span>%</label>
                            <input type="range" id="overlay-scale-slider" class="form-control" min="10" max="200" value="50" step="5">
                        </div>

                        <div class="form-group">
                            <label>Opacité : <span id="overlay-opacity-value">100</span>%</label>
                            <input type="range" id="overlay-opacity-slider" class="form-control" min="0" max="100" value="100" step="5">
                        </div>

                        <button id="apply-overlay-btn" class="btn btn-success" style="margin-right: 10px;">
                            <i class="fa fa-check"></i> Appliquer la fusion
                        </button>
                        <button id="remove-overlay-btn" class="btn btn-danger">
                            <i class="fa fa-times"></i> Retirer la 2e image
                        </button>
                    </div>
                </div>

                <h4 style="margin-top: 30px;">Pivoter</h4>

                <form id="form-rotate" action="{{ url_for('rotate') }}" method="POST" enctype="multipart/form-data">
                    <!-- Slider for angle selection (0-360) -->
                    <div class="form-group">
                        <label for="angleSlider">Angle de rotation :</label>
                        <input type="range" id="angleSlider" class="angle-slider" min="0" max="360" value="0" step="1">
                    </div>

                    <!-- Number input synchronized with slider -->
                    <div class="form-group">
                        <label for="angleInput">Angle (degrés) :</label>
                        <input type="number" id="angleInput" name="angle" min="0" max="360" value="0" placeholder="0-360" required>
                        <div id="angle-display" style="margin-top: 10px; padding: 10px; background: #e8f5e9; border-radius: 5px; font-weight: bold; text-align: center; color: #2e7d32;">
                            Angle actuel : <span id="current-angle-value">0</span>°
                        </div>
                    </div>

                    <!-- Quick rotation buttons -->
                    <div class="quick-rotation-buttons">
                        <button type="button" id="rotate90Btn" class="btn btn-sm btn-default">90°</button>
                        <button type="button" id="rotate180Btn" class="btn btn-sm btn-default">180°</button>
                        <button type="button" id="rotate270Btn" class="btn btn-sm btn-default">270°</button>
                        <button type="button" id="resetBtn" class="btn btn-sm btn-warning">Réinitialiser</button>
                    </div>

                    <input type="text" class="hidden" name="image" value="{{ image_name }}">
                    <p class="text-muted" style="margin-top: 10px; font-size: 12px;">
                        <i class="fa fa-info-circle"></i> La rotation s'applique automatiquement en temps réel
                    </p>
                </form>

                <!-- FONCTIONNALITÉ FUSIONNER - CACHÉE
                <h4>Fusionner</h4>
                <form id="form-blend" action="{{ url_for('blend') }}" method="POST" enctype="multipart/form-data">
                    <input type="number" name="alpha" placeholder="alpha (%)" min="0" max="100" required>
                    <button id="btnBlend" class="btn btn-lg btn-success" type="submit">Valider</button>
                    <input type="text" class="hidden" name="image" value="{{ image_name }}">
                </form>
                -->

            </div>
        </div>

        <!-- Download and Reset Buttons Section -->
        <div class="row" style="margin-top: 30px; margin-bottom: 30px;">
            <div class="col-lg-12 text-center">
                <button id="download-btn" class="btn btn-success btn-lg" style="padding: 15px 40px; font-size: 18px; margin-right: 15px;">
                    <i class="fa fa-download"></i> Télécharger l'image transformée
                </button>
                <button id="reset-all-btn" class="btn btn-warning btn-lg" style="padding: 15px 40px; font-size: 18px;">
                    <i class="fa fa-refresh"></i> Réinitialiser toutes les transformations
                </button>
            </div>
        </div>

        <footer class="footer">
            <p class="text-center"> Transformation d'Images.</p>
        </footer>

    </div>

    <!-- JavaScript for interactive rotation UI -->
    <script src="../static/rotation.js"></script>
</body>

</html>
